steps:
- checkout: self
  persistCredentials: true
- task: Bash@3
  displayName: 'set raw release branch'
  inputs:
    targetType: 'inline'
    script: |
      git config --global user.email "$(user.email)"
      git config --global user.name "$(user.name)"
      git checkout -b release/v$(release_version) origin/main
      git merge origin/dev
      git add -A
      git commit -m 'build_release_commit'
      git push origin release/v$(release_version)
- script: sbt "release release-version $(release_version) with-defaults"
  displayName: 'Running $ sbt "release release-version $(release_version) with-defaults"'
- task: Bash@3
  displayName: 'delete raw release/v$(release_version) branch'
  inputs:
    targetType: 'inline'
    script: |
      git push origin --delete release/v$(release_version)